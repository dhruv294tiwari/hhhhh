<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>College Attendance Tracker</title>
    
    <!-- PWA Meta Tags -->
    <meta name="theme-color" content="#667eea">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="Attendance Tracker">
    <meta name="description" content="Track your college attendance easily">
    
    <!-- PWA Icons -->
    <link rel="apple-touch-icon" href="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNTEyIiBoZWlnaHQ9IjUxMiIgdmlld0JveD0iMCAwIDUxMiA1MTIiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSI1MTIiIGhlaWdodD0iNTEyIiByeD0iMTAwIiBmaWxsPSIjNjY3ZWVhIi8+Cjx0ZXh0IHg9IjI1NiIgeT0iMzAwIiBmb250LWZhbWlseT0iQXJpYWwiIGZvbnQtc2l6ZT0iMjAwIiBmaWxsPSJ3aGl0ZSIgdGV4dC1hbmNob3I9Im1pZGRsZSI+8J+SnDwvdGV4dD4KPC9zdmc+">
    
    <!-- Web App Manifest -->
    <link rel="manifest" href="data:application/json;base64,ewogICJuYW1lIjogIkNvbGxlZ2UgQXR0ZW5kYW5jZSBUcmFja2VyIiwKICAic2hvcnRfbmFtZSI6ICJBdHRlbmRhbmNlIiwKICAiZGVzY3JpcHRpb24iOiAiVHJhY2sgeW91ciBjb2xsZWdlIGF0dGVuZGFuY2UgZWFzaWx5IiwKICAic3RhcnRfdXJsIjogIi4vIiwKICAiZGlzcGxheSI6ICJzdGFuZGFsb25lIiwKICAiYmFja2dyb3VuZF9jb2xvciI6ICIjNjY3ZWVhIiwKICAidGhlbWVfY29sb3IiOiAiIzY2N2VlYSIsCiAgImljb25zIjogWwogICAgewogICAgICAic3JjIjogImRhdGE6aW1hZ2Uvc3ZnK3htbDtiYXNlNjQsUEhOMlp5QjNhV1IwYUQwaU5URXlJaUJvWldsbmFIUTlJalV4TWlJZ2RtbGxkMEp2ZUQwaU1DQXdJRFV4TWlBMU1USWlJR1pwYkd3OUltNXZibVVpSUhodGJHNXpQU0pvZEhSd09pOHZkM2QzTG5jekxtOXlaeTh5TURBd0wzTjJaeUkrQ2p4eVpXTjBJSGRwWkhSb1BTSTFNVElpSUdobGFXZG9kRDBpTlRFeUlpQnllRDBpTVRBd0lpQm1hV3hzUFNJalpqWTNaV1ZoSWk4K0NqeDBaWGgwSUhnOUlqSTFOaUlnZVQwaU16QXdJaUJtYjI1MExXWmhiV2xzZVQwaVFYSnBZV3dpSUdadmJuUXRjMmw2WlQwaU1qQXdJaUJtYVd4c1BTSjNhR2wwWlNJZ2RHVjRkQzFoYm1Ob2IzSTlJbTFwWkdSc1pTSWdQREUwZmtwd2Rtb2dhWGxHWXlzM0lqNHNQQzluWlhoMFBnbzhMM04yWnorIiwKICAgICAgInNpemVzIjogIjUxMng1MTIiLAogICAgICAidHlwZSI6ICJpbWFnZS9zdmcreG1sIgogICAgfQogIF0sCiAgImxhbmd1YWdlIjogImVuIiwKICAib3JpZW50YXRpb24iOiAicG9ydHJhaXQiCn0=">
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }

        .container {
            max-width: 400px;
            margin: 0 auto;
            padding: 20px;
            min-height: 100vh;
        }

        .header {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 20px;
            margin-bottom: 20px;
            text-align: center;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }

        .header h1 {
            color: #4a5568;
            margin-bottom: 10px;
            font-size: 24px;
        }

        .overall-stats {
            display: flex;
            justify-content: space-between;
            margin-top: 15px;
        }

        .stat-item {
            text-align: center;
        }

        .stat-number {
            font-size: 20px;
            font-weight: bold;
            color: #667eea;
        }

        .stat-label {
            font-size: 12px;
            color: #666;
        }

        .today-section {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }

        .date-navigation {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 15px;
            background: rgba(102, 126, 234, 0.1);
            border-radius: 15px;
            padding: 10px;
        }

        .nav-btn {
            background: #667eea;
            color: white;
            border: none;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 18px;
            transition: all 0.3s ease;
            box-shadow: 0 2px 10px rgba(102, 126, 234, 0.3);
        }

        .nav-btn:hover {
            background: #5a67d8;
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
        }

        .nav-btn:disabled {
            background: #cbd5e0;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        .today-date {
            font-size: 16px;
            font-weight: bold;
            color: #4a5568;
            text-align: center;
            flex: 1;
        }

        .date-indicator {
            font-size: 12px;
            color: #667eea;
            font-weight: 500;
        }

        .class-card {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            border-radius: 15px;
            padding: 15px;
            margin-bottom: 10px;
            color: white;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }

        .class-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .class-name {
            font-weight: bold;
            font-size: 16px;
        }

        .class-time {
            font-size: 12px;
            opacity: 0.9;
        }

        .class-details {
            font-size: 14px;
            margin-bottom: 10px;
            opacity: 0.9;
        }

        .attendance-buttons {
            display: flex;
            gap: 10px;
        }

        .btn {
            flex: 1;
            padding: 8px 12px;
            border: none;
            border-radius: 10px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .btn-present {
            background: rgba(255, 255, 255, 0.2);
            color: white;
            border: 2px solid rgba(255, 255, 255, 0.3);
        }

        .btn-present.active {
            background: #48bb78;
            border-color: #48bb78;
        }

        .btn-absent {
            background: rgba(255, 255, 255, 0.2);
            color: white;
            border: 2px solid rgba(255, 255, 255, 0.3);
        }

        .btn-absent.active {
            background: #f56565;
            border-color: #f56565;
        }

        .subjects-section {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 20px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }

        .section-title {
            font-size: 18px;
            font-weight: bold;
            color: #4a5568;
            margin-bottom: 15px;
            text-align: center;
        }

        .subject-card {
            background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%);
            border-radius: 15px;
            padding: 15px;
            margin-bottom: 10px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }

        .subject-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 8px;
        }

        .subject-name {
            font-weight: bold;
            color: #4a5568;
        }

        .percentage {
            font-weight: bold;
            font-size: 18px;
        }

        .percentage.good {
            color: #48bb78;
        }

        .percentage.warning {
            color: #ed8936;
        }

        .percentage.danger {
            color: #f56565;
        }

        .subject-stats {
            display: flex;
            justify-content: space-between;
            font-size: 12px;
            color: #666;
        }

        .no-classes {
            text-align: center;
            color: #666;
            font-style: italic;
            padding: 20px;
        }

        .tab-container {
            display: flex;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            margin-bottom: 20px;
            overflow: hidden;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }

        .tab {
            flex: 1;
            padding: 12px;
            text-align: center;
            background: transparent;
            border: none;
            color: #666;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .tab.active {
            background: #667eea;
            color: white;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>📚 Attendance Tracker</h1>
            <div class="overall-stats">
                <div class="stat-item">
                    <div class="stat-number" id="totalPresent">0</div>
                    <div class="stat-label">Present</div>
                </div>
                <div class="stat-item">
                    <div class="stat-number" id="totalClasses">0</div>
                    <div class="stat-label">Total</div>
                </div>
                <div class="stat-item">
                    <div class="stat-number" id="overallPercentage">0%</div>
                    <div class="stat-label">Overall</div>
                </div>
            </div>
        </div>

        <div class="tab-container">
            <button class="tab active" onclick="switchTab('today')">Today</button>
            <button class="tab" onclick="switchTab('subjects')">Subjects</button>
        </div>

        <div id="todayTab" class="tab-content active">
            <div class="today-section">
                <div class="date-navigation">
                    <button class="nav-btn" onclick="changeDate(-1)" title="Previous Day">‹</button>
                    <div>
                        <div class="today-date" id="todayDate"></div>
                        <div class="date-indicator" id="dateIndicator"></div>
                    </div>
                    <button class="nav-btn" onclick="changeDate(1)" title="Next Day">›</button>
                </div>
                <div id="todayClasses"></div>
            </div>
        </div>

        <div id="subjectsTab" class="tab-content">
            <div class="subjects-section">
                <div class="section-title">📊 Subject Statistics</div>
                <div id="subjectsList"></div>
            </div>
        </div>
    </div>

    <script>
        // Timetable based on your schedule
        const timetable = {
            'Monday': [
                {name: 'TLW & AD', teacher: 'Dr. Sudarshan Kumar', time: '8:10-9:00', room: '446'},
                {name: 'DSP', teacher: 'Ms. Jyoti Gupta', time: '9:00-9:50', room: '446'},
                {name: 'Control Sys.', teacher: 'Dr. Neelu Nagpal', time: '9:50-10:40', room: '446'},
                {name: 'DCN', teacher: 'Dr. R.K.Choudhary', time: '10:40-11:30', room: '446'}
            ],
            'Tuesday': [
                {name: 'DSP', teacher: 'Ms. Jyoti Gupta', time: '9:00-09:50', room: '443'},
                {name: 'DSP2', teacher: 'Ms. Jyoti Gupta', time: '09:50-10:40', room: '443'},
                 {name: 'DCN', teacher: 'Dr. R.K.Choudhary', time: '10:40-11:30', room: '443'},
                {name: 'Control Sys.', teacher: 'Dr. Neelu Nagpal', time: '11:30-12:20', room: '443'},
                {name: 'TLW & AD', teacher: 'Dr. Sudarshan Kumar', time: '12:20-1:10', room: '443'},
                {name: 'Micro Elec.', teacher: 'Ms. Shalu Jindal', time: '1:40-2:30', room: '227'},
                {name: 'Eco For Eng.', teacher: 'Dr Shikha Saxena', time: '2:30-3:20', room: '227'}
            ],
            'Wednesday': [
               
                {name: 'DSP', teacher: 'Ms. Jyoti Gupta', time: '9:00-9:50', room: '443'},
                {name: 'Micro Elec.', teacher: 'Ms. Shalu Jindal', time: '9:50-10:40', room: '443'},
                {name: 'DCN', teacher: 'Dr. R.K.Choudhary', time: '10:40-11:30', room: '443'},
                {name: 'Micro Elec Lab', teacher: 'Dr. Amit Saxena', time: '11:30-12:20', room: '422'},
                {name: 'Micro Elec Lab 2', teacher: 'Dr. Amit Saxena', time: '12:20-1:10', room: '422'},
                {name: 'DSP Lab 2', teacher: 'Ms. Jyoti Gupta', time: '2:30-3:20', room: '416'},
                {name: 'DSP Lab ', teacher: 'Ms. Jyoti Gupta', time: '1:40-2:30', room: '416'}
                
            ],
            'Thursday': [
                
                
                {name: 'Eco For Eng.', teacher: 'Dr Shikha Saxena', time: '9:50-10:40', room: '401B'},
                {name: 'TLW & AD', teacher: 'Dr. Sudarshan Kumar', time: '10:40-11:30', room: '401B'},
                {name: 'DCN Lab', teacher: 'Mr. Saurabh Rastogi', time: '11:30-12:20', room: '332A/332B'},
                {name: 'DCN Lab2', teacher: 'Mr. Saurabh Rastogi', time: '12:20-1:10', room: '332A/332B'},
                {name: 'Control Sys.', teacher: 'Dr. Neelu Nagpal', time: '1:40-2:30', room: '446'},
                 {name: 'DCN', teacher: 'Dr. R.K.Choudhary', time: '2:30-3:20', room: '446'},
            ],
            'Friday': [
                {name: 'Micro Elec.', teacher: 'Ms. Shalu Jindal', time: '9:50-10:40', room: '401B'},
                {name: 'TLW & AD', teacher: 'Dr. Sudarshan Kumar', time: '10:40-11:30', room: '401B'},
                {name: 'TLW & AD Lab', teacher: 'Dr. Sudarshan Kumar', time: '11:30-12.20', room: '432'},
                  {name: 'TLW & AD Lab1', teacher: 'Dr. Sudarshan Kumar', time: '12.20-1:10', room: '432'},
                
                {name: 'Control Sys. Lab', teacher: 'Dr. Neelu Nagpal', time: '1:40-2.30', room: '623 A},
                 {name: 'Control Sys. Lab2', teacher: 'Dr. Neelu Nagpal', time: '2.30-3:20', room: '623 A'}
            ]
        };

        // Initialize data
        let attendanceData = JSON.parse(localStorage.getItem('attendanceData')) || {};
        let subjectStats = JSON.parse(localStorage.getItem('subjectStats')) || {};
        let currentViewDate = new Date(); // Track which date we're viewing

        // Get date info for any date
        function getDateInfo(date = new Date()) {
            const days = ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'];
            const months = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];
            
            return {
                dayName: days[date.getDay()],
                date: date.getDate(),
                month: months[date.getMonth()],
                year: date.getFullYear(),
                fullDate: date.toDateString(),
                dateObj: new Date(date)
            };
        }

        // Get current date info
        function getCurrentDateInfo() {
            return getDateInfo(new Date());
        }

        // Change viewing date
        function changeDate(direction) {
            currentViewDate.setDate(currentViewDate.getDate() + direction);
            displayTodayClasses();
        }

        // Get date indicator text
        function getDateIndicator(viewDate) {
            const today = new Date();
            const diffTime = viewDate.getTime() - today.getTime();
            const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
            
            if (diffDays === 0) return "Today";
            if (diffDays === -1) return "Yesterday";
            if (diffDays === 1) return "Tomorrow";
            if (diffDays < -1) return `${Math.abs(diffDays)} days ago`;
            if (diffDays > 1) return `In ${diffDays} days`;
            return "";
        }

        // Initialize subject stats
        function initializeSubjectStats() {
            const allSubjects = new Set();
            Object.values(timetable).forEach(day => {
                day.forEach(cls => allSubjects.add(cls.name));
            });
            
            allSubjects.forEach(subject => {
                if (!subjectStats[subject]) {
                    subjectStats[subject] = { present: 0, total: 0 };
                }
            });
        }

        // Mark attendance
        function markAttendance(subject, date, status) {
            const key = `${subject}_${date}`;
            const oldStatus = attendanceData[key];
            attendanceData[key] = status;
            
            // Update subject stats
            if (!subjectStats[subject]) {
                subjectStats[subject] = { present: 0, total: 0 };
            }
            
            if (oldStatus === undefined) {
                // New entry
                subjectStats[subject].total++;
                if (status === 'present') {
                    subjectStats[subject].present++;
                }
            } else if (oldStatus !== status) {
                // Status changed
                if (status === 'present') {
                    subjectStats[subject].present++;
                } else {
                    subjectStats[subject].present--;
                }
            }
            
            // Save to localStorage
            localStorage.setItem('attendanceData', JSON.stringify(attendanceData));
            localStorage.setItem('subjectStats', JSON.stringify(subjectStats));
            
            updateDisplay();
        }

        // Get attendance status
        function getAttendanceStatus(subject, date) {
            const key = `${subject}_${date}`;
            return attendanceData[key];
        }

        // Display today's classes
        function displayTodayClasses() {
            const dateInfo = getDateInfo(currentViewDate);
            const todayClasses = timetable[dateInfo.dayName] || [];
            
            document.getElementById('todayDate').textContent = 
                `${dateInfo.dayName}, ${dateInfo.date} ${dateInfo.month} ${dateInfo.year}`;
            
            // Update date indicator
            document.getElementById('dateIndicator').textContent = getDateIndicator(currentViewDate);
            
            const container = document.getElementById('todayClasses');
            
            if (todayClasses.length === 0) {
                container.innerHTML = '<div class="no-classes">🎉 No classes today!</div>';
                return;
            }
            
            container.innerHTML = todayClasses.map(cls => {
                const status = getAttendanceStatus(cls.name, dateInfo.fullDate);
                return `
                    <div class="class-card">
                        <div class="class-header">
                            <div class="class-name">${cls.name}</div>
                            <div class="class-time">${cls.time}</div>
                        </div>
                        <div class="class-details">
                            👨‍🏫 ${cls.teacher} • 🏫 Room ${cls.room}
                        </div>
                        <div class="attendance-buttons">
                            <button class="btn btn-present ${status === 'present' ? 'active' : ''}" 
                                    onclick="markAttendance('${cls.name}', '${dateInfo.fullDate}', 'present')">
                                ✅ Present
                            </button>
                            <button class="btn btn-absent ${status === 'absent' ? 'active' : ''}" 
                                    onclick="markAttendance('${cls.name}', '${dateInfo.fullDate}', 'absent')">
                                ❌ Absent
                            </button>
                        </div>
                    </div>
                `;
            }).join('');
        }

        // Display subjects statistics
        function displaySubjects() {
            const container = document.getElementById('subjectsList');
            
            const subjects = Object.keys(subjectStats).sort();
            
            container.innerHTML = subjects.map(subject => {
                const stats = subjectStats[subject];
                const percentage = stats.total > 0 ? Math.round((stats.present / stats.total) * 100) : 0;
                
                let percentageClass = 'good';
                if (percentage < 75) percentageClass = 'danger';
                else if (percentage < 85) percentageClass = 'warning';
                
                return `
                    <div class="subject-card">
                        <div class="subject-header">
                            <div class="subject-name">${subject}</div>
                            <div class="percentage ${percentageClass}">${percentage}%</div>
                        </div>
                        <div class="subject-stats">
                            <span>Present: ${stats.present}</span>
                            <span>Total: ${stats.total}</span>
                            <span>Absent: ${stats.total - stats.present}</span>
                        </div>
                    </div>
                `;
            }).join('');
        }

        // Update overall statistics
        function updateOverallStats() {
            let totalPresent = 0;
            let totalClasses = 0;
            
            Object.values(subjectStats).forEach(stats => {
                totalPresent += stats.present;
                totalClasses += stats.total;
            });
            
            const overallPercentage = totalClasses > 0 ? Math.round((totalPresent / totalClasses) * 100) : 0;
            
            document.getElementById('totalPresent').textContent = totalPresent;
            document.getElementById('totalClasses').textContent = totalClasses;
            document.getElementById('overallPercentage').textContent = overallPercentage + '%';
        }

        // Switch tabs
        function switchTab(tabName) {
            // Update tab buttons
            document.querySelectorAll('.tab').forEach(tab => tab.classList.remove('active'));
            event.target.classList.add('active');
            
            // Update tab content
            document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
            document.getElementById(tabName + 'Tab').classList.add('active');
            
            if (tabName === 'subjects') {
                displaySubjects();
            }
        }

        // Update all displays
        function updateDisplay() {
            displayTodayClasses();
            displaySubjects();
            updateOverallStats();
        }

        // Initialize app
        function init() {
            initializeSubjectStats();
            updateDisplay();
        }

        // Start the app
        init();
    </script>
</body>
</html>
